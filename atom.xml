<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>孤独巡礼</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="zhou1996.github.io/"/>
  <updated>2017-04-13T07:44:20.000Z</updated>
  <id>zhou1996.github.io/</id>
  
  <author>
    <name>君の名は</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>随机验证码</title>
    <link href="zhou1996.github.io/2017/02/10/Verification/"/>
    <id>zhou1996.github.io/2017/02/10/Verification/</id>
    <published>2017-02-10T01:36:00.000Z</published>
    <updated>2017-04-13T07:44:20.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="随机验证码"><a href="#随机验证码" class="headerlink" title="随机验证码"></a>随机验证码</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line">$width = <span class="number">80</span>;</div><div class="line">$height = <span class="number">30</span>;</div><div class="line">$type = <span class="number">3</span>;</div><div class="line">$len = <span class="number">4</span>;</div><div class="line">$line = <span class="number">4</span>;</div><div class="line">$pixel = <span class="number">50</span>;</div><div class="line"></div><div class="line"><span class="comment">// 1.创建画布</span></div><div class="line">$image = imagecreatetruecolor($width,$height);</div><div class="line"></div><div class="line"><span class="comment">// 2.创建颜色</span></div><div class="line">$white = imagecolorallocate($image,<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>);</div><div class="line">$black = imagecolorallocate($image,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">// 3.填充整个矩形区域</span></div><div class="line">imagefilledrectangle($image,<span class="number">1</span>,<span class="number">1</span>,$width<span class="number">-2</span>,$height<span class="number">-2</span>,$white);</div><div class="line"></div><div class="line"><span class="comment">// 4.准备字符串</span></div><div class="line">$str = getStr($type,$len);</div><div class="line"><span class="comment">// 5.准备字体</span></div><div class="line">$fontFile = <span class="keyword">array</span>(<span class="string">"Deng.ttf"</span>,<span class="string">"Dengb.ttf"</span>,<span class="string">"Dengl.ttf"</span>,<span class="string">"FZYTK.TTF"</span>,</div><div class="line"><span class="string">"msyh.ttc"</span>,</div><div class="line"><span class="string">"msyhbd.ttc"</span>,</div><div class="line"><span class="string">"msyhl.ttc"</span>,</div><div class="line"><span class="string">"simfang.ttf"</span>,</div><div class="line"><span class="string">"STLITI.TTF"</span>,</div><div class="line"><span class="string">"STXINWEI.TTF"</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 6.单独绘制文字</span></div><div class="line"><span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;strlen($str); $i++)&#123;</div><div class="line">    $size = mt_rand(<span class="number">14</span>, <span class="number">18</span>);</div><div class="line">    $angle = mt_rand(<span class="number">-15</span>, <span class="number">15</span>);</div><div class="line">    $x = <span class="number">5</span> + $size*$i;</div><div class="line">    $y = mt_rand(<span class="number">20</span>, <span class="number">26</span>);</div><div class="line">    $color = imagecolorallocate($image, mt_rand(<span class="number">90</span>, <span class="number">120</span>),mt_rand(<span class="number">100</span>,<span class="number">200</span>),mt_rand(<span class="number">120</span>,<span class="number">250</span>));</div><div class="line">    $font_file = <span class="string">"font/"</span>.$fontFile[mt_rand(<span class="number">0</span>,count($fontFile)<span class="number">-1</span>)];</div><div class="line">    $text = substr($str,$i,<span class="number">1</span>);</div><div class="line">    imagettftext($image, $size, $angle, $x, $y, $color, $font_file, $text);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 7.干扰元素--点</span></div><div class="line"><span class="keyword">if</span>($pixel)&#123;</div><div class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;$pixel; $i++)&#123;</div><div class="line">        imagesetpixel($image, mt_rand(<span class="number">1</span>, $width<span class="number">-2</span>), mt_rand(<span class="number">1</span>, $height<span class="number">-2</span>), $black);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 9.干扰元素--线</span></div><div class="line"><span class="keyword">if</span>($line)&#123;</div><div class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;$line; $i++)&#123;</div><div class="line">        $color = imagecolorallocate($image, mt_rand(<span class="number">90</span>, <span class="number">120</span>),mt_rand(<span class="number">100</span>,<span class="number">200</span>),mt_rand(<span class="number">120</span>,<span class="number">250</span>));</div><div class="line">        imageline($image, mt_rand(<span class="number">1</span>, $width<span class="number">-2</span>), mt_rand(<span class="number">0</span>, $height<span class="number">-2</span>), mt_rand(<span class="number">1</span>, $width<span class="number">-2</span>), mt_rand(<span class="number">0</span>, $height<span class="number">-2</span>),$color);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 输出图片</span></div><div class="line">header(<span class="string">"content-type:image/gif"</span>);</div><div class="line"><span class="comment">// 输出图像到浏览器或文件</span></div><div class="line">imagegif($image);</div><div class="line"><span class="comment">// 销毁一图像</span></div><div class="line">imagedestroy($image);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@param</span> $type 类型：1-纯数字； 2-纯字母； 3-数字+字母</div><div class="line"> * <span class="doctag">@param</span> $len 验证码的长度</div><div class="line"> * <span class="doctag">@return</span> string 验证码的字符串</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStr</span><span class="params">($type=<span class="number">1</span>,$len=<span class="number">4</span>)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> ($type == <span class="number">1</span>) &#123;</div><div class="line">        $str = <span class="string">"1234567890"</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($type == <span class="number">2</span>) &#123;</div><div class="line">        $str = <span class="string">"dsajfoisadjf"</span>;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        $str = <span class="string">"1234567890abcdefghijklmnopqrstuvwxyz"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 将字符串打乱</span></div><div class="line">    $chars = str_shuffle($str);</div><div class="line">    <span class="comment">// 截取$len个长度的字符串，并返回</span></div><div class="line">    <span class="keyword">return</span> substr($chars, <span class="number">0</span>, $len);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><br></p>
<p><span style="font-size:12px;color:#888">封面画师: <a href="http://www.pixiv.net/member_illust.php?mode=medium&amp;illust_id=62289173" target="_blank" rel="external">wlop</a></span></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;随机验证码&quot;&gt;&lt;a href=&quot;#随机验证码&quot; class=&quot;headerlink&quot; title=&quot;随机验证码&quot;&gt;&lt;/a&gt;随机验证码&lt;/h2&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;
    
    </summary>
    
      <category term="JS" scheme="zhou1996.github.io/categories/JS/"/>
    
    
      <category term="JS" scheme="zhou1996.github.io/tags/JS/"/>
    
      <category term="验证码" scheme="zhou1996.github.io/tags/%E9%AA%8C%E8%AF%81%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>安装mysql和使用</title>
    <link href="zhou1996.github.io/2017/02/10/useMysql/"/>
    <id>zhou1996.github.io/2017/02/10/useMysql/</id>
    <published>2017-02-10T01:36:00.000Z</published>
    <updated>2017-04-13T09:22:21.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><h3 id="下载mysqli"><a href="#下载mysqli" class="headerlink" title="下载mysqli"></a>下载mysqli</h3><pre><code>地址：https://dev.mysql.com/downloads/mysql/
</code></pre><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>打开mysql的安装目录（mysql-5.7.17-winx64），复制一份 my-default.ini
并将其改名为my.ini 打开my.in文件修改如以下内容
</code></pre><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attr">basedir</span> = C:\wbroot\mysql-<span class="number">5.7</span>.<span class="number">17</span>-winx64</div><div class="line"><span class="attr">datadir</span> = C:\wbroot\mysql-<span class="number">5.7</span>.<span class="number">17</span>-winx64\data</div><div class="line"><span class="attr">port</span> = <span class="number">3306</span></div></pre></td></tr></table></figure>
<pre><code>注意：路径根据mysqli安装路径来决定
</code></pre><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><pre><code>在系统属性中的 path 中输入mysqli 安装的目录文件中bin的路径
启动管理员 并输入 mysqld -install 成功后输入net start mysql
显示启动成功。
</code></pre><h3 id="安装mysqli"><a href="#安装mysqli" class="headerlink" title="安装mysqli"></a>安装mysqli</h3><pre><code>1.打开mysqli 命令 net start mysql
2.关闭mysqli 命令 net stop mysql
</code></pre><h3 id="登录mysql"><a href="#登录mysql" class="headerlink" title="登录mysql"></a>登录mysql</h3><pre><code>1. mysqli -u root -p
2.设置密码 mysqladmin -u root password &quot;设置密码&quot;;
</code></pre><h3 id="mysql数据库相关操作"><a href="#mysql数据库相关操作" class="headerlink" title="mysql数据库相关操作"></a>mysql数据库相关操作</h3><pre><code>1.查看数据库 show databases;
2.创建一个数据库 create database 数据库名; 例creata database book;
3.删除一个数据库 drop database 数据库名;   例drop database book;
4.使用数据库 use 数据库名  例use book;
5.删除数据表 drop table 表名;
6.删除所有数据 delete from user;
</code></pre><h3 id="mysql数据表的相关操作"><a href="#mysql数据表的相关操作" class="headerlink" title="mysql数据表的相关操作"></a>mysql数据表的相关操作</h3><pre><code>1.创建表 create table book_version(id int,name varchar(20));
2.查看数据表 show sables;
3.查看表结构 desc user(表名);
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| id    | int(11)     | YES  |     | NULL    |       |
| name  | varchar(20) | YES  |     | NULL    |       |
| sex   | char(1)     | YES  |     | NULL    |       |
+-------+-------------+------+-----+---------+-------+
Field：字段
Type：类型
Null：是否允许存储为空
Key：是否设置主键或外键
Default：默认
Extra：附加消息

补充：
一张表中只能有一个主键

4.查看表的详细信息 show create table `user\G`; 加上\G更容易查看详细信息

5.查询数据 select * form user;
6.向表中插入数据  insert into user(name) values(&quot;jack&quot;);
7.向表中插入多列数据 insert into user(id,name,age) values(1,&quot;jack&quot;,16);
8.消除记录中的重复数据 select distinct name from user;
9.from子句，限定的表名 select `Name` from world.user;
10.from子句，未限定的表名 select `Name` from user;
11.修改表中的数据 update user set age=25,name=&quot;Tam&quot; where id=2;(修改id=2的age和name字段的数据)
12.删除表中的数据 delete from user where id=1 and id=2;(删除id为1和2的表中数据)
13.删除表中所有数据 delete from user;
14.查询表中数据 select * from 表名 where 字段名
15.从下标1开始查找3个记录 select * from user limit 1,3
16.查询表里有多少条记录 select count(*) from user; 

在有聚合函数的情况下使用的判断语句having
分组查询每个组的最高成绩 select c_name,max(grade) from score group by c_name;
分组查询每个组的平均成绩 select c_name,avg(grade) as avg_grade(as avg_grade:别名) from score group by c_name;
union
</code></pre><h4 id="4-3-order-by语句"><a href="#4-3-order-by语句" class="headerlink" title="4.3 order by语句"></a>4.3 order by语句</h4><pre><code>1.order by 表名 asc|desc; //order by默认是升序的为asc，降序为desc
如：select * from user order by name desc;设置使用name排序,方式为降序 
</code></pre><h3 id="5-修改数据表结构"><a href="#5-修改数据表结构" class="headerlink" title="5.修改数据表结构"></a>5.修改数据表结构</h3><pre><code>+ 将id改成int(10) 修改指定字段的数据类型: alter table `user` modify `id` int(10);
+ 将增加一个age字段 alter table user add `age` int(2);
+ 将id设为主键 alter table user add primary key (id);
+ 将id设为唯一字段 alter table user add unique (id);
</code></pre><h3 id="mysql支持的存储引擎"><a href="#mysql支持的存储引擎" class="headerlink" title="mysql支持的存储引擎"></a>mysql支持的存储引擎</h3><pre><code>1.Myisan
2.InnoDB 主要使用这2个
</code></pre><h3 id="mysql忘记root密码"><a href="#mysql忘记root密码" class="headerlink" title="mysql忘记root密码"></a>mysql忘记root密码</h3><pre><code>1. 在DOS窗口下输入`net stop mysql` 
2. 开一个DOS窗口，这个需要切换到mysql的bin目录

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqld --skip-grant-tables;</div></pre></td></tr></table></figure>

不要关闭窗口
3. 再开一个DOS窗口，`mysql -u root` 
4. 输入
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">use mysql </div><div class="line">update mysql.user set authentication_string=password(&apos;123qwe&apos;) where user=&apos;root&apos; and Host = &apos;localhost&apos;; </div><div class="line">flush privileges; </div><div class="line">exit</div></pre></td></tr></table></figure>

5. 使用任务管理器，找到mysqld-nt的进程，结束进程
</code></pre><h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><pre><code>函数名称                    函数作用
min(filede_name)           求字段的最小值
max(filede_name)           求字段的最大值
</code></pre><h3 id="学生表相关查询"><a href="#学生表相关查询" class="headerlink" title="学生表相关查询"></a>学生表相关查询</h3><ol>
<li>查询student表的所有记录</li>
</ol>
<ul>
<li>select * from student;</li>
</ul>
<ol>
<li>查询student表的第2条到4条selec记录</li>
</ol>
<ul>
<li>select * from student limit 1,3;</li>
</ul>
<ol>
<li>从student表查询所有学生的学号（id）、姓名（name）和院系（department）的信息</li>
</ol>
<ul>
<li>select id,name,department from student;</li>
</ul>
<ol>
<li>从student表中查询slex计算机系和英语系的学生的信息</li>
</ol>
<ul>
<li>select * from student where department=”计算机系” or department=”英语系”;</li>
</ul>
<ol>
<li>从student表中查询年龄18~22岁的学生信息</li>
</ol>
<ul>
<li>select * from student where birth&lt;=1999 and birth&gt;=1995;</li>
</ul>
<ol>
<li>从score表中查询每个科目的最高分</li>
</ol>
<ul>
<li>select c_name,grade from score group by c_name;</li>
</ul>
<ol>
<li>查询都是湖南的学生的姓名、年龄、院系和考试科目及成绩</li>
</ol>
<ul>
<li>select student.id,name,address,birth,department,c_name,grade from student,score </li>
<li>where student.address like”湖南%” and student.id=score.stu_id;</li>
</ul>
<ol>
<li>查询计算机成绩低于95的学生信息</li>
</ol>
<ul>
<li>SELECT * FROM student WHERE id IN (SELECT stu_id FROM score WHERE c_name =”计算机” and grade&lt;95);</li>
</ul>
<ol>
<li>查询每个科目的最高成绩</li>
</ol>
<ul>
<li>select c_name,max(grade) from score group by c_name;</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;mysql&quot;&gt;&lt;a href=&quot;#mysql&quot; class=&quot;headerlink&quot; title=&quot;mysql&quot;&gt;&lt;/a&gt;mysql&lt;/h2&gt;&lt;h3 id=&quot;下载mysqli&quot;&gt;&lt;a href=&quot;#下载mysqli&quot; class=&quot;headerlink&quot; titl
    
    </summary>
    
      <category term="mysql" scheme="zhou1996.github.io/categories/mysql/"/>
    
    
      <category term="mysql语句" scheme="zhou1996.github.io/tags/mysql%E8%AF%AD%E5%8F%A5/"/>
    
  </entry>
  
  <entry>
    <title>PHP数据库操作</title>
    <link href="zhou1996.github.io/2017/01/12/PHP_MySqli/"/>
    <id>zhou1996.github.io/2017/01/12/PHP_MySqli/</id>
    <published>2017-01-12T03:06:00.000Z</published>
    <updated>2017-04-13T09:32:56.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="PHP数据库操作"><a href="#PHP数据库操作" class="headerlink" title="PHP数据库操作"></a>PHP数据库操作</h2><p>设置字符集<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</div></pre></td></tr></table></figure></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$host = <span class="string">"localhost"</span>;</div><div class="line">$username = <span class="string">"root"</span>;</div><div class="line">$password = <span class="string">"root"</span>;</div><div class="line">$dbname = <span class="string">"comment"</span>;</div></pre></td></tr></table></figure>
<ol>
<li><p>连接数据库</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$mysqli = <span class="keyword">new</span> mysqli($host, $username, $password);</div></pre></td></tr></table></figure>
</li>
<li><p>打开指定的数据库</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$mysqli-&gt;select_db($dbname);</div><div class="line"><span class="comment">//echo $mysqli-&gt;errno;</span></div><div class="line"><span class="keyword">if</span>($mysqli-&gt;connect_errno)&#123;</div><div class="line">    <span class="keyword">exit</span>(<span class="string">"数据库连接失败:"</span>.$mysqli-&gt;connect_errno);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>设置客户端字符集</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$mysqli-&gt;set_charset(<span class="string">"utf8"</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>执行结果集</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 数据库增删改查</div><div class="line"> */</div><div class="line"><span class="comment">//查询内容</span></div><div class="line">$sql = <span class="string">"select * from login"</span>;</div><div class="line"></div><div class="line"><span class="comment">//增加内容</span></div><div class="line">$sql = <span class="string">"insert into login(username,password,email) VALUES('jong','asdf','123sadf4@324'),('jack','234','1234sd@324')"</span>;</div><div class="line"></div><div class="line"><span class="comment">//删除内容</span></div><div class="line">$sql = <span class="string">"delete from login where id=40"</span>;</div><div class="line"></div><div class="line"><span class="comment">//修改内容</span></div><div class="line">$sql = <span class="string">"update login set username='jack' where id=2"</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//mysqli_result 返回mysqli的result结果集的对象   执行增删查改用的</span></div><div class="line">$res = $mysqli-&gt;query($sql);</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="取出查询的结果集"><a href="#取出查询的结果集" class="headerlink" title="取出查询的结果集"></a>取出查询的结果集</h3><ul>
<li><p>fetch_all()：取出结果集中的所有数据，默认返回一个二维索引数组</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * MYSQLI_NUM:返回索引数组</div><div class="line"> * MYSQLI_ASSOC:返回关联数组</div><div class="line"> * MYSQLI_BOTH:返回关联+索引数组</div><div class="line"> */</div><div class="line">print_r($res-&gt;fetch_all(MYSQLI_ASSOC));</div></pre></td></tr></table></figure>
</li>
<li><p>fetch_array():取出结果集中的一条数据，并使用索引+关联数组方式返回</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print_r($res-&gt;fetch_array());</div></pre></td></tr></table></figure>
</li>
<li><p>fetch_row():取出结果集中的一条数据，返回的是索引数组</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print_r($res-&gt;fetch_row());</div></pre></td></tr></table></figure>
</li>
<li><p>fetch_object():从结果集中取得一行作为对象</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print_r($res-&gt;fetch_object());</div></pre></td></tr></table></figure>
</li>
<li><p>fetch_assoc():返回结果集中的一条数据作为关联数组</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">print_r($res-&gt;fetch_assoc());</div><div class="line"><span class="comment">/** affected_rows:打印受影响的记录条数</span></div><div class="line"> * 1.n 受影响的记录条数</div><div class="line"> * 2.-1，代表SQL语句有问题</div><div class="line"> * 3.0，代表没有受影响的记录条数</div><div class="line"> */</div><div class="line">var_dump($mysqli-&gt;affected_rows);</div></pre></td></tr></table></figure>
</li>
</ul>
<ol>
<li><p>释放结果集</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$res-&gt;free_result();</div></pre></td></tr></table></figure>
</li>
<li><p>关闭连接</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$mysqli-&gt;close();</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">header(<span class="string">"content-type: text/html; charset=utf-8"</span>);</div><div class="line">$host = <span class="string">"localhost"</span>;</div><div class="line">$username = <span class="string">"root"</span>;</div><div class="line">$password = <span class="string">"root"</span>;</div><div class="line">$dbname = <span class="string">"comment"</span>;</div><div class="line">$mysqli = <span class="keyword">new</span> mysqli($host, $username, $password, $dbname);</div><div class="line"></div><div class="line"><span class="keyword">if</span>($mysqli-&gt;connect_errno)&#123;</div><div class="line">    <span class="keyword">exit</span>(<span class="string">"数据库连接失败:"</span>.$mysqli-&gt;connect_error);</div><div class="line">&#125;</div><div class="line">$mysqli-&gt;set_charset(<span class="string">"utf8"</span>);</div></pre></td></tr></table></figure>
<ol>
<li><p>准备预处理语句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//?指的是占位符</span></div><div class="line">$sql = <span class="string">"select * from login where username=?"</span>;</div><div class="line">$mysqli_stmt = $mysqli-&gt;prepare($sql);</div><div class="line">var_dump($mysqli_stmt);</div><div class="line">$username = <span class="string">"admin"</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>绑定参数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * s: 字符串</div><div class="line"> * i：整型</div><div class="line"> * d：double</div><div class="line"> */</div><div class="line">$mysqli_stmt-&gt;bind_param(<span class="string">"s"</span>, $username);</div></pre></td></tr></table></figure>
</li>
<li><p>执行预处理语句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$e = $mysqli_stmt-&gt;execute();</div><div class="line"><span class="keyword">if</span>($e)&#123;</div><div class="line"><span class="comment">//    echo $mysqli_stmt-&gt;insert_id;</span></div><div class="line">    $rows = <span class="keyword">null</span>;</div><div class="line">   <span class="comment">/* while($row = $mysqli_stmt-&gt;fetch())&#123;</span></div><div class="line">        print_r($row);</div><div class="line">    &#125;*/</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//print_r($rows);</span></div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="PDO"><a href="#PDO" class="headerlink" title="PDO"></a>PDO</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">    $dsn = <span class="string">"mysql:host=localhost;dbname=comment"</span>;</div><div class="line">    $username = <span class="string">"root"</span>;</div><div class="line">    $password = <span class="string">"root"</span>;</div><div class="line">    $pdo = <span class="keyword">new</span> PDO($dsn,$username,$password);</div><div class="line"><span class="comment">// 增   $sql = "insert into login(username,password,email)VALUES ('MM','123','23@324')";</span></div><div class="line"><span class="comment">// 删   $sql = "delete from login WHERE id=50";</span></div><div class="line"><span class="comment">// 改   $sql = "update login set username='XM' WHERE id=51";</span></div><div class="line"><span class="comment">//    $res = $pdo-&gt;exec($sql);</span></div><div class="line"><span class="comment">// 查</span></div><div class="line">    $sql = <span class="string">"select * from login"</span>;</div><div class="line">    $pdo_stm = $pdo-&gt;query($sql);</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * FETCH_BOTH</div><div class="line">     * FETCH_ASSOC</div><div class="line">     * FETCH_NUM</div><div class="line">     */</div><div class="line">    print_r($pdo_stm-&gt;fetchAll(PDO::FETCH_ASSOC));</div><div class="line">    <span class="comment">/*foreach ($pdo_stm as $row) &#123;</span></div><div class="line">        $rows[] = $row;</div><div class="line">    &#125;</div><div class="line">    print_r($rows);*/</div><div class="line"></div><div class="line">    <span class="comment">//异常处理</span></div><div class="line">&#125;<span class="keyword">catch</span>(PDOException $e)&#123;</div><div class="line">    <span class="keyword">echo</span> $e-&gt;getMessage();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="PDO预处理"><a href="#PDO预处理" class="headerlink" title="PDO预处理"></a>PDO预处理</h3><ul>
<li>连接数据库<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">    $dsn = <span class="string">"mysql:host=localhost;dbname=comment"</span>;</div><div class="line">    $username = <span class="string">"root"</span>;</div><div class="line">    $password = <span class="string">"root"</span>;</div><div class="line">    $pdo = <span class="keyword">new</span> PDO($dsn,$username,$password);</div></pre></td></tr></table></figure>
</li>
</ul>
<ol>
<li><p>准备预处理</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$sql = <span class="string">"insert into login(username,password,email) VALUES (?,?,?)"</span>;</div><div class="line">$sth = $pdo-&gt;prepare($sql);</div></pre></td></tr></table></figure>
</li>
<li><p>绑定参数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$username = <span class="string">"XXM"</span>;</div><div class="line">$password = md5(<span class="string">"123"</span>);</div><div class="line">$email = <span class="string">"sadf@qq.com"</span>;</div><div class="line"><span class="comment">/*  $sth-&gt;bindParam(1,$username);</span></div><div class="line">$sth-&gt;bindParam(2,$password);</div><div class="line">$sth-&gt;bindParam(3,$email);*/</div></pre></td></tr></table></figure>
</li>
<li><p>执行预处理</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">    $res = $sth-&gt;execute(<span class="keyword">array</span>($username,$password,$email));</div><div class="line"></div><div class="line">    print_r($res);</div><div class="line"></div><div class="line">&#125;<span class="keyword">catch</span>(PDOException $e)&#123;</div><div class="line">    $e-&gt;getMessage();</div><div class="line">&#125;</div></pre></td></tr></table></figure></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;PHP数据库操作&quot;&gt;&lt;a href=&quot;#PHP数据库操作&quot; class=&quot;headerlink&quot; title=&quot;PHP数据库操作&quot;&gt;&lt;/a&gt;PHP数据库操作&lt;/h2&gt;&lt;p&gt;设置字符集&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;
    
    </summary>
    
      <category term="PHP" scheme="zhou1996.github.io/categories/PHP/"/>
    
    
      <category term="PHP" scheme="zhou1996.github.io/tags/PHP/"/>
    
      <category term="数据库操作" scheme="zhou1996.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/"/>
    
  </entry>
  
</feed>
